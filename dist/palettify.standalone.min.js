/*!
 * palettify v0.0.0 
 * (c) 2017 Dobromir Hristov
 * Released under the MIT License.
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("@mariotacke/color-thief")):"function"==typeof define&&define.amd?define(["@mariotacke/color-thief"],t):e.palettify=t(e.colorThief)}(this,function(e){"use strict";function t(e){switch(typeof e){case"string":case"number":case"boolean":return e;case"object":try{return null===e?"":JSON.stringify(e)}catch(e){return"{...}"}default:return""}}function n(e,t,a){if(void 0===a&&(a=0),"object"!=typeof e||null===e||void 0===e)return"";var r=t[a],o=e[r];return a===t.length-1?o:n(o,t,++a)}function a(e,t){return n(t,e.split("."))}function r(e,n,r){return void 0===n&&(n={}),void 0===r&&(r=a),"string"!=typeof e?e:e.replace(i,function(e,o){try{return t(r(o,n))}catch(e){return t(a(o,n))}})}function o(){function t(t,n){var a=t;if(!t)throw Error("Target is not an element",t);if("IMG"!==t.tagName){if(!t.style.backgroundImage)throw Error("Tag provided is not an image and does not have a background-image style attached to it.");a=new Image(t.offsetWidth,t.offsetHeight),a.src=t.style.backgroundImage.replace("url(","").replace(")","").replace(/"/gi,"")}return(new e).getPalette(a,n)}function n(e,t){return e.map(function(e,n){var r=1;return Array.isArray(t)&&t[n]&&(r=t[n]),a(e,r)})}function a(e,t){return"rgba("+e[0]+", "+e[1]+", "+e[2]+", "+t+")"}function r(e,t,n){for(var a in t)t.hasOwnProperty(a)&&(e.style[a]=s(t[a],n))}function o(e,t,n,a){for(var r in t)t.hasOwnProperty(r)&&!n.hasOwnProperty(r)?e.style[r]="":n.hasOwnProperty(r)&&(e.style[r]=s(n[r],a))}function i(e){p.options=Object.assign({},f,e),Object.keys(p.options).forEach(function(e){if(p.options[e]instanceof Error)throw p.options[e]})}var l=!1,c=null,f={selector:Error("Please provide \u0430 selector in your options."),eventTarget:Error("Please provide an eventTarget as a parent for your image in the options."),image:Error("Please provide an image to sample."),styleTarget:null,opacities:[.5,.5,.5],activeClass:"palettify--active",readyClass:"palettify--ready",colorsToExtract:3,enterEvent:"mouseenter",leaveEvent:"mouseleave",staticStyles:{},dynamicStyles:{},beforeEnterCallback:null,afterEnterCallback:null,beforeLeaveCallback:null,afterLeaveCallback:null,onReadyCallback:null},p={options:{},data:[],collectElements:function(){var e="";(c="string"==typeof p.options.selector?document.querySelector(p.options.selector):p.options.selector)&&(e=c.querySelectorAll(p.options.eventTarget),[].slice.call(e,0).forEach(function(e){var t=e.querySelector(p.options.image),n=e.querySelector(p.options.styleTarget||p.options.image),a={eventTarget:e,styleTarget:n,image:t,palette:{original:[],rgb:[],rgba:[]}};p.data.push(a)}))},extractColorsAndAttachStyles:function(){p.data.forEach(function(e){e.palette.original=t(e.image,p.options.colorsToExtract),e.palette.rgb=n(e.palette.original,[]),e.palette.rgba=n(e.palette.original,p.options.opacities),r(e.styleTarget,p.options.staticStyles,e.palette)}),c.classList.add(p.options.readyClass)},generateEnterHandler:function(e){return function(t){e.styleTarget&&("function"==typeof p.options.beforeEnterCallback&&p.options.beforeEnterCallback.call(e.styleTarget,e.palette,t,p.options),e.styleTarget.classList.add(p.options.activeClass),r(e.styleTarget,p.options.dynamicStyles,e.palette),"function"==typeof p.options.afterEnterCallback&&p.options.afterEnterCallback.call(e.styleTarget,e.palette,t,p.options))}},generateLeaveHandler:function(e){return function(t){var n=e.styleTarget;n&&(p.options.beforeLeaveCallback&&p.options.beforeLeaveCallback.call(e.styleTarget,e.palette,t,p.options),n.classList.remove(p.options.activeClass),o(e.styleTarget,p.options.dynamicStyles,p.options.staticStyles,e.palette),p.options.afterLeaveCallback&&p.options.afterLeaveCallback.call(e.styleTarget,e.palette,t,p.options))}},attachEventListeners:function(){var e=p.options,t=e.enterEvent,n=e.leaveEvent;t=Array.isArray(t)?t:[t],n=Array.isArray(n)?n:[n],p.data.forEach(function(e){e.enterHandler=p.generateEnterHandler(e),e.leaveHandler=p.generateLeaveHandler(e),t.forEach(function(t){e.eventTarget.addEventListener(t,e.enterHandler,!1)}),n.forEach(function(t){e.eventTarget.addEventListener(t,e.leaveHandler,!1)})})},detachEventListeners:function(){var e=p.options,t=e.enterEvent,n=e.leaveEvent;t=Array.isArray(t)?t:[t],n=Array.isArray(n)?n:[n],p.data.forEach(function(e){t.forEach(function(t){e.eventTarget.removeEventListener(t,e.enterHandler,!1)}),n.forEach(function(t){e.eventTarget.removeEventListener(t,e.leaveHandler,!1)})})},init:function(e){if(l)throw new Error("Palettify is already initialized");return i(e),p.collectElements(),p.extractColorsAndAttachStyles(),p.attachEventListeners(),l=!0,"function"==typeof p.options.onReadyCallback&&p.options.onReadyCallback.call(p,p),p},destroy:function(e){void 0===e&&(e=!0),p.detachEventListeners(),e&&p.cleanUp(),p.data=[],l=!1},reInit:function(){p.destroy(),p.init(p.options)},cleanUp:function(){p.data.forEach(function(e){for(var t in p.options.staticStyles)p.options.staticStyles.hasOwnProperty(t)&&(e.styleTarget.style[t]="")})},setOptions:function(e,t){void 0===t&&(t=!0),p.options=Object.assign({},p.options,e),t&&p.reInit()},isInitialized:function(){return l}};return p}e="default"in e?e.default:e;var i=/\{\{\s*(.*?)\s*\}\}/g,l=r,s=l;return o});